<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unravel日语歌词学习游戏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .info-item {
            text-align: center;
        }
        
        .info-item .label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }
        
        .info-item .value {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }
        
        .game-container {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .question-section {
            margin-bottom: 25px;
        }
        
        .lyric-line {
            font-size: 1.8em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            color: #333;
        }
        
        .lyric-translation {
            font-size: 1.1em;
            text-align: center;
            color: #00cec9;
            margin-bottom: 15px;
            font-style: italic;
        }
        
        .romaji {
            font-size: 1.3em;
            text-align: center;
            color: #666;
            margin-bottom: 15px;
        }
        
        .accent-mark { font-size: 1.1em; color: #ff4757; font-weight: bold; }
        .pause-mark { color: #5352ed; font-weight: bold; }
        .question-word { color: #ff4757; font-weight: bold; }
        
        .pronunciation-tip {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }
        
        .pronunciation-tip h3 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .grammar-explanation {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #00cec9;
        }
        
        .grammar-explanation h3 {
            color: #00cec9;
            margin-bottom: 10px;
        }
        
        .options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .option-btn {
            padding: 15px;
            font-size: 1.1em;
            border: none;
            border-radius: 8px;
            background: #f1f2f6;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }
        
        .option-btn:hover {
            background: #dfe4ea;
            transform: translateY(-2px);
        }
        
        .option-btn.correct {
            background: #2ed573;
            color: white;
        }
        
        .option-btn.wrong {
            background: #ff4757;
            color: white;
        }
        
        .game-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .control-btn {
            padding: 12px 25px;
            font-size: 1.1em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .next-btn {
            background: #667eea;
            color: white;
        }
        
        .next-btn:hover {
            background: #5352ed;
            transform: translateY(-2px);
        }
        
        .restart-btn {
            background: #ffa502;
            color: white;
        }
        
        .restart-btn:hover {
            background: #ff6348;
            transform: translateY(-2px);
        }
        
        .wrong-answers {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .wrong-answers h2 {
            color: #ff4757;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .wrong-list {
            list-style: none;
        }
        
        .wrong-item {
            padding: 15px;
            margin-bottom: 10px;
            background: #ffeaa7;
            border-radius: 8px;
            border-left: 4px solid #ff4757;
        }
        
        .result-section {
            text-align: center;
            padding: 30px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .result-section h2 {
            font-size: 2em;
            margin-bottom: 20px;
            color: #667eea;
        }
        
        .score-display {
            font-size: 3em;
            font-weight: bold;
            color: #2ed573;
            margin-bottom: 20px;
        }
        
        .accuracy {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Unravel 歌词学习游戏</h1>
            <p>通过歌词学习日语语法和发音</p>
        </header>
        
        <div class="game-info">
            <div class="info-item">
                <div class="label">得分</div>
                <div class="value" id="score">0</div>
            </div>
            <div class="info-item">
                <div class="label">时间</div>
                <div class="value" id="timer">00:00</div>
            </div>
            <div class="info-item">
                <div class="label">题目</div>
                <div class="value" id="questionCount">1/10</div>
            </div>
        </div>
        
        <div class="game-container" id="gameContainer">
            <div class="question-section">
                <div class="lyric-line" id="lyricLine"></div>
                <div class="lyric-translation" id="lyricTranslation"></div>
                <div class="romaji" id="romajiLine"></div>
                
                <div class="pronunciation-tip">
                    <h3>发音提示</h3>
                    <div id="pronunciationTip"></div>
                </div>
                
                <div class="grammar-explanation">
                    <h3>语法解释</h3>
                    <div id="grammarExplanation"></div>
                </div>
                
                <div class="question">
                    <h3>问题</h3>
                    <div id="questionText" style="font-size: 1.2em; margin-bottom: 20px;"></div>
                </div>
                
                <div class="options">
                    <button class="option-btn" onclick="selectOption(0)"></button>
                    <button class="option-btn" onclick="selectOption(1)"></button>
                    <button class="option-btn" onclick="selectOption(2)"></button>
                    <button class="option-btn" onclick="selectOption(3)"></button>
                </div>
            </div>
            
            <div class="game-controls">
                <button class="control-btn next-btn" onclick="nextQuestion()">下一题</button>
                <button class="control-btn restart-btn" onclick="restartGame()">重新开始</button>
            </div>
        </div>
        
        <div class="wrong-answers" id="wrongAnswers">
            <h2>错题集</h2>
            <ul class="wrong-list" id="wrongList"></ul>
        </div>
    </div>
    
    <script>
        // 《unravel》歌词题库数据
        const unravelLyrics = [
            {
                id: 1,
                lyric: "教（おし）えてよ <span class='accent-mark'>教</span>えてよ",
                translation: "告诉我吧 告诉我吧",
                romaji: "o.shi.e.te.yo <span class='accent-mark'>o</span>.shi.e.te.yo",
                pronunciation: "注意 <span class='accent-mark'>お</span> 的重音，<span class='pause-mark'>.</span> 表示短暂停顿",
                grammarPoint: "「教えてよ」是动词「教える」的て形加上终助词「よ」，用于向对方提出请求",
                question: "「<span class='question-word'>教えてよ</span>」是什么意思？",
                options: [
                    "请告诉我",
                    "我教你",
                    "已经教了",
                    "正在教"
                ],
                correctAnswer: 0
            },
            {
                id: 2,
                lyric: "その <span class='accent-mark'>仕組</span>（しくみ）を",
                translation: "那个构造",
                romaji: "so.no <span class='accent-mark'>shi</span>ku.mi.o",
                pronunciation: "<span class='accent-mark'>し</span> 是重音，<span class='pause-mark'>.</span> 表示短暂停顿",
                grammarPoint: "「仕組み」是名词，由动词「仕組む」转化而来，常用于描述事物的结构或运作机制",
                question: "「<span class='question-word'>仕組み</span>」的意思是？",
                options: [
                    "结构、构造",
                    "组织、团体",
                    "工作、职业",
                    "计划、打算"
                ],
                correctAnswer: 0
            },
            {
                id: 3,
                lyric: "僕（ぼく）の <span class='accent-mark'>中</span>（なか）に誰（だれ）かいるの？",
                translation: "我的内心深处有谁存在吗？",
                romaji: "bo.ku.no <span class='accent-mark'>na</span>ka.ni.da.re.ka.i.ru.no?",
                pronunciation: "「中」的重音在 <span class='accent-mark'>な</span> 上，<span class='pause-mark'>.</span> 表示短暂停顿",
                grammarPoint: "「～の中に」是由格助词「の」、名词「中」和格助词「に」组成的表达，用于指示位置",
                question: "「～の<span class='question-word'>中に</span>」表示什么？",
                options: [
                    "在...内部",
                    "在...中间",
                    "在...上面",
                    "在...下面"
                ],
                correctAnswer: 0
            },
            {
                id: 4,
                lyric: "<span class='accent-mark'>壊</span>（こわ）れた <span class='pause-mark'>◯</span> 壊れたよ",
                translation: "坏掉了 坏掉了啊",
                romaji: "<span class='accent-mark'>ko</span>wa.re.ta <span class='pause-mark'>◯</span> ko.wa.re.ta.yo",
                pronunciation: "「壊れた」的重音在 <span class='accent-mark'>こ</span> 上，<span class='pause-mark'>◯</span> 处稍作停顿",
                grammarPoint: "「壊れた」是「壊れる」的过去式，表示损坏、破碎",
                question: "「<span class='question-word'>壊れた</span>」的意思是？",
                options: [
                    "损坏了",
                    "正在损坏",
                    "要损坏",
                    "没损坏"
                ],
                correctAnswer: 0
            },
            {
                id: 5,
                lyric: "この <span class='accent-mark'>世界</span>（せかい）で",
                translation: "在这个世界上",
                romaji: "ko.no <span class='accent-mark'>se</span>kai.de",
                pronunciation: "「世界」的重音在 <span class='accent-mark'>せ</span> 上，<span class='pause-mark'>.</span> 表示短暂停顿",
                grammarPoint: "「この世界で」意为在这个世界上",
                question: "「この<span class='question-word'>世界</span>で」的意思是？",
                options: [
                    "在这个世界上",
                    "在那个世界上",
                    "在世界之外",
                    "关于世界"
                ],
                correctAnswer: 0
            },
            {
                id: 6,
                lyric: "君（きみ）が <span class='accent-mark'>笑</span>（わら）う",
                translation: "你笑了",
                romaji: "ki.mi.ga <span class='accent-mark'>wa</span>ra.u",
                pronunciation: "「笑う」的重音在 <span class='accent-mark'>わ</span> 上，<span class='pause-mark'>.</span> 表示短暂停顿",
                grammarPoint: "「笑う」意为笑，这里指对方的笑容",
                question: "「<span class='question-word'>笑う</span>」的意思是？",
                options: [
                    "笑",
                    "哭",
                    "说",
                    "听"
                ],
                correctAnswer: 0
            },
            {
                id: 7,
                lyric: "何（なに）も <span class='accent-mark'>見</span>（み）えずに",
                translation: "什么都看不见",
                romaji: "na.ni.mo <span class='accent-mark'>mi</span>e.zu.ni",
                pronunciation: "「見えず」的重音在 <span class='accent-mark'>み</span> 上，<span class='pause-mark'>.</span> 表示短暂停顿",
                grammarPoint: "「見えずに」是「見えない」的文语形，表示看不见",
                question: "「<span class='question-word'>見えずに</span>」的意思是？",
                options: [
                    "看不见",
                    "看得清楚",
                    "正在看",
                    "看了"
                ],
                correctAnswer: 0
            },
            {
                id: 8,
                lyric: "<span class='accent-mark'>壊</span>（こわ）れた人間（にんげん）だけど",
                translation: "虽然我是个坏掉的人",
                romaji: "<span class='accent-mark'>ko</span>wa.re.ta.nin.gen.da.ke.do",
                pronunciation: "「壊れた」的重音在 <span class='accent-mark'>こ</span> 上，<span class='pause-mark'>.</span> 表示短暂停顿",
                grammarPoint: "「だけど」表示转折，意为虽然...但是...",
                question: "「<span class='question-word'>だけど</span>」表示什么关系？",
                options: [
                    "转折",
                    "因果",
                    "并列",
                    "递进"
                ],
                correctAnswer: 0
            },
            {
                id: 9,
                lyric: "忘（わす）れたくない <span class='accent-mark'>忘</span>れたくないんだ",
                translation: "不想忘记 真的不想忘记",
                romaji: "wa.su.re.ta.ku.na.i <span class='accent-mark'>wa</span>.su.re.ta.ku.na.in.da",
                pronunciation: "「忘れたくない」的重音在 <span class='accent-mark'>わ</span> 上，<span class='pause-mark'>.</span> 表示短暂停顿",
                grammarPoint: "「忘れたくない」是「忘れる」的「たくない」形式，表示不想忘记",
                question: "「<span class='question-word'>忘れたくない</span>」的意思是？",
                options: [
                    "不想忘记",
                    "已经忘记",
                    "正在忘记",
                    "想忘记"
                ],
                correctAnswer: 0
            },
            {
                id: 10,
                lyric: "変（か）わってしまった <span class='accent-mark'>変</span>えられなかった",
                translation: "已经改变了 无法再变回原来的样子",
                romaji: "ka.wa.tte.shi.ma.tta <span class='accent-mark'>ka</span>.e.ra.re.na.kat.ta",
                pronunciation: "「変えられなかった」的重音在 <span class='accent-mark'>か</span> 上，<span class='pause-mark'>.</span> 表示短暂停顿",
                grammarPoint: "「変えられなかった」是「変える」的可能态否定过去式，表示没能改变",
                question: "「<span class='question-word'>変えられなかった</span>」的意思是？",
                options: [
                    "没能改变",
                    "已经改变",
                    "正在改变",
                    "想改变"
                ],
                correctAnswer: 0
            }
        ];
        
        // 游戏状态
        let currentQuestion = 0;
        let score = 0;
        let wrongAnswers = [];
        let timer = 0;
        let timerInterval;
        let gameStarted = false;
        let selectedOption = -1;
        
        // DOM元素
        const lyricLineElement = document.getElementById('lyricLine');
        const lyricTranslationElement = document.getElementById('lyricTranslation');
        const romajiLineElement = document.getElementById('romajiLine');
        const pronunciationTipElement = document.getElementById('pronunciationTip');
        const grammarExplanationElement = document.getElementById('grammarExplanation');
        const questionTextElement = document.getElementById('questionText');
        const optionButtons = document.querySelectorAll('.option-btn');
        const scoreElement = document.getElementById('score');
        const timerElement = document.getElementById('timer');
        const questionCountElement = document.getElementById('questionCount');
        const wrongListElement = document.getElementById('wrongList');
        
        // 初始化游戏
        function initGame() {
            startTimer();
            loadQuestion();
        }
        
        // 开始计时器
        function startTimer() {
            timerInterval = setInterval(() => {
                timer++;
                const minutes = Math.floor(timer / 60).toString().padStart(2, '0');
                const seconds = (timer % 60).toString().padStart(2, '0');
                timerElement.textContent = `${minutes}:${seconds}`;
            }, 1000);
        }
        
        // 洗牌函数
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // 加载题目
        function loadQuestion() {
            if (currentQuestion >= unravelLyrics.length) {
                endGame();
                return;
            }
            
            const question = unravelLyrics[currentQuestion];
            selectedOption = -1;
            
            // 清空选项状态
            optionButtons.forEach(btn => {
                btn.className = 'option-btn';
                btn.disabled = false;
            });
            
            // 显示题目
            lyricLineElement.innerHTML = question.lyric;
            lyricTranslationElement.textContent = question.translation;
            romajiLineElement.innerHTML = question.romaji;
            pronunciationTipElement.innerHTML = question.pronunciation;
            grammarExplanationElement.innerHTML = question.grammarPoint;
            questionTextElement.innerHTML = question.question;
            
            // 打乱选项
            const shuffledOptions = shuffleArray(question.options);
            const correctIndex = shuffledOptions.indexOf(question.options[question.correctAnswer]);
            
            // 设置选项
            shuffledOptions.forEach((option, index) => {
                optionButtons[index].textContent = option;
            });
            
            // 更新题目计数
            questionCountElement.textContent = `${currentQuestion + 1}/${unravelLyrics.length}`;
            
            // 保存当前问题的正确答案索引
            unravelLyrics[currentQuestion].shuffledCorrectAnswer = correctIndex;
        }
        
        // 选择选项
        function selectOption(optionIndex) {
            if (selectedOption !== -1) return;
            
            selectedOption = optionIndex;
            const question = unravelLyrics[currentQuestion];
            
            // 标记答案
            optionButtons.forEach((btn, index) => {
                if (index === question.shuffledCorrectAnswer) {
                    btn.classList.add('correct');
                } else if (index === optionIndex) {
                    btn.classList.add('wrong');
                }
                btn.disabled = true;
            });
            
            // 计分
            if (optionIndex === question.shuffledCorrectAnswer) {
                score += 10;
            } else {
                wrongAnswers.push({
                    question: question.question,
                    userAnswer: optionButtons[optionIndex].textContent,
                    correctAnswer: optionButtons[question.shuffledCorrectAnswer].textContent,
                    lyric: question.lyric
                });
            }
            
            scoreElement.textContent = score;
            updateWrongAnswers();
        }
        
        // 下一题
        function nextQuestion() {
            if (selectedOption === -1) {
                alert('请先选择一个答案！');
                return;
            }
            
            currentQuestion++;
            loadQuestion();
        }
        
        // 更新错题集
        function updateWrongAnswers() {
            wrongListElement.innerHTML = '';
            
            wrongAnswers.forEach((item, index) => {
                const li = document.createElement('li');
                li.className = 'wrong-item';
                li.innerHTML = `
                    <strong>第${index + 1}题：</strong>${item.question}<br>
                    <strong>歌词：</strong>${item.lyric}<br>
                    <strong>你的答案：</strong>${item.userAnswer}<br>
                    <strong>正确答案：</strong>${item.correctAnswer}
                `;
                wrongListElement.appendChild(li);
            });
        }
        
        // 重新开始游戏
        function restartGame() {
            clearInterval(timerInterval);
            currentQuestion = 0;
            score = 0;
            wrongAnswers = [];
            timer = 0;
            gameStarted = false;
            
            scoreElement.textContent = '0';
            timerElement.textContent = '00:00';
            wrongListElement.innerHTML = '';
            
            initGame();
        }
        
        // 结束游戏
        function endGame() {
            clearInterval(timerInterval);
            
            const gameContainer = document.getElementById('gameContainer');
            const accuracy = Math.round((score / (unravelLyrics.length * 10)) * 100);
            
            gameContainer.innerHTML = `
                <div class="result-section">
                    <h2>游戏结束！</h2>
                    <div class="score-display">${score}分</div>
                    <div class="accuracy">准确率：${accuracy}%</div>
                    <div class="game-controls">
                        <button class="control-btn restart-btn" onclick="restartGame()">重新开始</button>
                    </div>
                </div>
            `;
        }
        
        // 页面加载完成后初始化游戏
        document.addEventListener('DOMContentLoaded', () => {
            initGame();
        });
    </script>
</body>
</html>